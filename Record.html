<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Record Dialog</title>
  <style type="text/css">
   .table {
     border: 1px solid black;
   }
  </style>
  </head>
  <body onkeydown="keyDown(event)">
    <p id="pressEnter">Set Actor KeyCodes before Recording!</p>
    <div id="setup">
      <button id="btn1" onclick="setActorKeyCode(1)">Set Actor 1 KeyCode</button>
      <p id="currentKeyCode1">Current: none</p><br/>
      <button id="btn2" onclick="setActorKeyCode(2)">Set Actor 2 KeyCode</button>
      <p id="currentKeyCode2">Current: none</p><br/>
    </div>
    <table id="outputTable">
      <tr>
        <th>Actor 1</th>
        <th>Actor 2</th>
      </tr>
    </table>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
    <script>
        var actor1KeyCode = -1;
        var actor2KeyCode = -1;
        var settingKeyCode = false;
        var actorKeyCodeToSet = "";
        var currentlyRecording = false;
        var startTimeStamp;
        
        function setActorKeyCode(actorNum)
        {
          if (!settingKeyCode)
          {
            $('#btn1').prop('disabled', true);
            $('#btn2').prop('disabled', true);
            actorKeyCodeToSet = actorNum;
            settingKeyCode = true;
            if (actorNum == 1)
            {
              $('#currentKeyCode1').html('Setting Actor 1 KeyCode');
            }
            else
            {
              $('#currentKeyCode2').html('Setting Actor 2 KeyCode');
            }
          }
        }
        
        function keyDown(event)
        {
          if ((settingKeyCode) && (event.keyCode != 13)) //don't allow 'enter' for actors
          {
            if (actorKeyCodeToSet == 1)
            {
              actor1KeyCode = event.keyCode;
              $('#currentKeyCode1').html('Current: ' + event.keyCode);
            }
            else
            {
              actor2KeyCode = event.keyCode;
              $('#currentKeyCode2').html('Current: ' + event.keyCode);
            }
            settingKeyCode = false;
            $('#btn1').prop('disabled', false);
            $('#btn2').prop('disabled', false);
            if ((actor1KeyCode != -1) && (actor2KeyCode != -1))
            {
              $('#pressEnter').html('Press \'Enter\' to start recording.');
            }
          }
          else if ((actor1KeyCode != -1) && (actor2KeyCode != -1) && (event.keyCode == 13) && (!currentlyRecording))
          {
            $('#setup').css('display','none');
            currentlyRecording = true;
            startTimeStamp = Date.now();
            $('#pressEnter').html('Press \'Enter\' to stop recording.');
          }
          else if (currentlyRecording)
          {
            if (event.keyCode == 13)
            {
              currentlyRecording = false;
              $('#pressEnter').html('Finished Recording');
            }
            else if (event.keyCode == actor1KeyCode)
            {
              var timeStamp = Date.now() - startTimeStamp;
              alert("TEST");
              $('#outputTable tr:last').after('<tr><td></td><td></td>' + timeStamp + '</tr>');
            }
          }
        }
    </script>
  </body>
</html>
